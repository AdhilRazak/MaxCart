<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="/css/admin/addproduct.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.slim.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
</head>

<body>

    <section id="menu">
        <div class="logo">
            <img src="/images/logo.png" alt="">
            <h2>Maxcart</h2>
        </div>
        <div class="items">
            <li><i class="fa-solid fa-chart-pie"></i> <a href="/admin/dashboard">Dashboard</a></li>
            <li><i class="fa-solid fa-table-cells-large"></i> <a href="/admin/product">Products</a></li>
            <li> <i class="fa-solid fa-list" style="color: #adb1b8;"></i> <a href="/admin/categories">Categories</a>
            </li>
            <li><i class="fa-solid fa-credit-card"></i> <a href="/admin/orders">Orders</a></li>
            <li><i class="fa-solid fa-user" style="color: #919191;"></i><a href="/admin/adminuserlist">Users</a></li>
            <li><i class="fa-solid fa-image"></i><a href="/admin/banner">Banner</a></li>
            <li><i class="fa-solid fa-ticket" style="color: #919191;"></i><a href="/admin/coupon">Coupen</a></li>


            <!-- <li><i class="fa-solid fa-chart-line"></i> <a href="#">Blank</a></li> -->
            <div class="logout">
                <li><i class="fa-solid fa-right-from-bracket" style="color: #d40c48;"></i> <a
                        href="/admin/logout">Logout</a></li>
            </div>
        </div>

    </section>



    <section id="interface">
        <div class="navigation">
            <div class="n1">
                <div>

                    <i id="menu-btn" class="fa-solid fa-bars"></i>
                </div>

            </div>


        </div>
        <h3 class="i-name">Add Products</h3>
        <div class="content_part">
            <form id="add_product_form" action="/admin/addproduct" method="post" enctype="multipart/form-data">
                <div class="frame">
                    <div class="gap_div">
                        <div class="card_div">
                            <div class="form-group">
                                <label for="productName">Product Name</label>
                                <div id="add_product_name_error"></div>
                                <input type="text" id="productName" name="productName" placeholder="Enter product name"
                                    required>
                            </div>

                            <div class="form-group">
                                <label for="title">Title</label>
                                <div id="add_product_title_error"></div>
                                <input type="text" id="title" name="title" placeholder="Enter title" required>
                            </div>

                            <div class="form-group">
                                <label for="write">Write</label>
                                <div id="add_product_write_error"></div>
                                <input type="text" id="write" name="write" placeholder="Enter write" required>
                            </div>

                            <div class="form-group">
                                <label for="prices">Price</label>
                                <div id="add_product_price_error"></div>
                                <input type="number" id="prices" name="prices" placeholder="Enter price" required>
                            </div>

                            <div class="form-group">
                                <label for="discount">Discount</label>
                                <div id="add_product_discount_error"></div>
                                <input type="number" id="discount" name="discount" placeholder="Enter discount"
                                    required>
                            </div>

                            <div class="form-group">
                                <label for="stock">Stock</label>
                                <div id="add_product_stock_error"></div>
                                <input type="number" id="stock" name="stock" placeholder="Enter stock" required>
                            </div>

                            <div class="form-group">
                                <label for="deliveryDate">Delivery Date</label>
                                <div id="add_product_delivery-date_error"></div>
                                <input type="text" id="deliveryDate" name="deliveryDate"
                                    placeholder="Enter delivery date" required>
                            </div>

                            <div class="form-group">
                                <label for="colour">Colour</label>
                                <div id="add_product_colour_error"></div>
                                <select name="color" id="colour" required>
                                    <option value="" selected disabled>Select color</option>
                                    <option value="red" style="color: #ff0000;">Red</option>
                                    <option value="Blue" style="color: #0000ff;">Blue</option>
                                    <option value="Green" style="color: #00ff00;">Green</option>
                                    <option value="Black" style="color: #000000;">Black</option>
                                    <option value="Orange" style="color: #f98000;">Orange</option>
                                    <option value="Yellow" style="color: #ffea00;">Yellow</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="size">Size</label>
                                <div id="add_product_size_error"></div>
                                <select name="size" id="size" required>
                                    <option value="" selected disabled>Choose Size</option>
                                    <option value="Small">Small</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Large">Large</option>
                                    <option value="X-Large">X-Large</option>
                                    <option value="Xx-Large">XX-Large</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="description">Description</label>
                                <div id="add_product_description_error"></div>
                                <textarea id="description" name="description" class="descriptions" required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="category">Category</label>
                                <div id="add_product_category_error"></div>
                                <select id="category" name="category" required>
                                    <option value="" selected disabled>Select category</option>
                                    <!-- Add your options dynamically here -->
                                </select>
                            </div>

                            <div class="form-group" id="subcategory_display_div"
                                style="display:block; padding: 0.5rem; border-radius: 4px;  margin-left: -10px;">
                                <label for="subCategory">Sub Category</label>
                                <div id="add_product_sub-category_error"></div>
                                <select name="subCategory" id="subCategory" style="width:344px" onchange="select(e)"
                                    required>
                                    <option selected disabled>Select sub category</option>
                                    <!-- Add your options dynamically here -->
                                </select>
                            </div>

                            <div class="form-group">
                                <div class="message" style="color: red; margin-bottom: 10px; font-weight: bold;"></div>
                                <button class="buttonsubmit" type="submit" id="add_product_btn">Submit</button>
                            </div>
                        </div>
                    </div>
                    <div class="img_div">
                        <div class="form-group img_centr">
                            <div class="image_space">
                                <img src="" alt="" id="imagePreview" style="width: 100%; height: 100%;">
                            </div>
                            <div id="add_product_image_error"></div>
                            <div class="image_buttn">
                                <input type="file" id="productImage" name="productImage" onchange="previewImage(this)"
                                    multiple required>
                            </div>
                            <div id="errorMain" style="color: brown; margin-top: 1rem;"></div>
                        </div>
                    </div>
                </div>
            </form>
        </div>


        </div>
    </section>
    <script>
        function previewImage(input) {
            var file = input.files[0];
            if (file) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('imagePreview').src = e.target.result;
                };
                reader.readAsDataURL(file);
            } else {
                document.getElementById("imagePreview").setAttribute('src', 'https://via.placeholder.com/150');
            }
        }

        function handleSubmit(event) {
            event.preventDefault(); // Prevent the default form submission

            // Serialize form data
            const formData = new FormData(event.target);
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });

            // Make an AJAX request to submit the form data
            axios.post(event.target.action, data)
                .then(response => {
                    // If response is ok, reload the page or do whatever you want
                    window.location.href = '/admin/product';
                })
                .catch(error => {
                    // Check if the error response contains an error message
                    if (error.response && error.response.data && error.response.data.error) {
                        // Display the error message using SweetAlert
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: error.response.data.error
                        });
                    } else {
                        // If no specific error message, show a generic error message
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'Something went wrong. Please try again later.'
                        });
                    }
                });
        }

        // Attach event listener to the form submission
        document.querySelector('form').addEventListener('submit', handleSubmit);

        $('#menu-btn').click(function () {
            $('#menu').toggleClass('active')
        })

    </script>

</body>

</html>